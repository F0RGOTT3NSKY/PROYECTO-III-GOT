\doxysection*{ ~\newline
 ~\newline
 }

\begin{quote}
Simple key-\/value storage with support for multiple backends \end{quote}


\href{https://travis-ci.org/lukechilds/keyv}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv?branch=master}{\texttt{ }} \href{https://www.npmjs.com/package/keyv}{\texttt{ }} \href{https://www.npmjs.com/package/keyv}{\texttt{ }}

Keyv provides a consistent interface for key-\/value storage across multiple backends via storage adapters. It supports T\+TL based expiry, making it suitable as a cache or a persistent key-\/value store.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5089}{}\doxysubsection{Features}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5089}
There are a few existing modules similar to Keyv, however Keyv is different because it\+:


\begin{DoxyItemize}
\item Isn\textquotesingle{}t bloated
\item Has a simple Promise based A\+PI
\item Suitable as a T\+TL based cache or persistent key-\/value store
\item \href{\#add-cache-support-to-your-module}{\texttt{ Easily embeddable}} inside another module
\item Works with any storage that implements the \href{https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map}{\texttt{ {\ttfamily Map}}} A\+PI
\item Handles all J\+S\+ON types plus {\ttfamily Buffer}
\item Supports namespaces
\item Wide range of \href{\#official-storage-adapters}{\texttt{ {\bfseries{efficient, well tested}}}} storage adapters
\item Connection errors are passed through (db failures won\textquotesingle{}t kill your app)
\item Supports the current active L\+TS version of Node.\+js or higher
\end{DoxyItemize}\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5090}{}\doxysubsection{Usage}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5090}
Install Keyv.


\begin{DoxyCode}{0}
\DoxyCodeLine{npm install -\/-\/save keyv}
\end{DoxyCode}


By default everything is stored in memory, you can optionally also install a storage adapter.


\begin{DoxyCode}{0}
\DoxyCodeLine{npm install -\/-\/save @keyv/redis}
\DoxyCodeLine{npm install -\/-\/save @keyv/mongo}
\DoxyCodeLine{npm install -\/-\/save @keyv/sqlite}
\DoxyCodeLine{npm install -\/-\/save @keyv/postgres}
\DoxyCodeLine{npm install -\/-\/save @keyv/mysql}
\end{DoxyCode}


Create a new Keyv instance, passing your connection string if applicable. Keyv will automatically load the correct storage adapter.


\begin{DoxyCode}{0}
\DoxyCodeLine{const Keyv = require('keyv');}
\DoxyCodeLine{}
\DoxyCodeLine{// One of the following}
\DoxyCodeLine{const keyv = new Keyv();}
\DoxyCodeLine{const keyv = new Keyv('redis://user:pass@localhost:6379');}
\DoxyCodeLine{const keyv = new Keyv('mongodb://user:pass@localhost:27017/dbname');}
\DoxyCodeLine{const keyv = new Keyv('sqlite://path/to/database.sqlite');}
\DoxyCodeLine{const keyv = new Keyv('postgresql://user:pass@localhost:5432/dbname');}
\DoxyCodeLine{const keyv = new Keyv('mysql://user:pass@localhost:3306/dbname');}
\DoxyCodeLine{}
\DoxyCodeLine{// Handle DB connection errors}
\DoxyCodeLine{keyv.on('error', err => console.log('Connection Error', err));}
\DoxyCodeLine{}
\DoxyCodeLine{await keyv.set('foo', 'expires in 1 second', 1000); // true}
\DoxyCodeLine{await keyv.set('foo', 'never expires'); // true}
\DoxyCodeLine{await keyv.get('foo'); // 'never expires'}
\DoxyCodeLine{await keyv.delete('foo'); // true}
\DoxyCodeLine{await keyv.clear(); // undefined}
\end{DoxyCode}
\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5091}{}\doxysubsubsection{Namespaces}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5091}
You can namespace your Keyv instance to avoid key collisions and allow you to clear only a certain namespace while using the same database.


\begin{DoxyCode}{0}
\DoxyCodeLine{const users = new Keyv('redis://user:pass@localhost:6379', \{ namespace: 'users' \});}
\DoxyCodeLine{const cache = new Keyv('redis://user:pass@localhost:6379', \{ namespace: 'cache' \});}
\DoxyCodeLine{}
\DoxyCodeLine{await users.set('foo', 'users'); // true}
\DoxyCodeLine{await cache.set('foo', 'cache'); // true}
\DoxyCodeLine{await users.get('foo'); // 'users'}
\DoxyCodeLine{await cache.get('foo'); // 'cache'}
\DoxyCodeLine{await users.clear(); // undefined}
\DoxyCodeLine{await users.get('foo'); // undefined}
\DoxyCodeLine{await cache.get('foo'); // 'cache'}
\end{DoxyCode}
\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5092}{}\doxysubsubsection{Custom Serializers}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5092}
Keyv uses \href{https://github.com/dominictarr/json-buffer}{\texttt{ {\ttfamily json-\/buffer}}} for data serialization to ensure consistency across different backends.

You can optionally provide your own serialization functions to support extra data types or to serialize to something other than J\+S\+ON.


\begin{DoxyCode}{0}
\DoxyCodeLine{const keyv = new Keyv(\{ serialize: JSON.stringify, deserialize: JSON.parse \});}
\end{DoxyCode}


{\bfseries{Warning\+:}} Using custom serializers means you lose any guarantee of data consistency. You should do extensive testing with your serialisation functions and chosen storage engine.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5093}{}\doxysubsection{Official Storage Adapters}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5093}
The official storage adapters are covered by \href{https://travis-ci.org/lukechilds/keyv/jobs/260418145}{\texttt{ over 150 integration tests}} to guarantee consistent behaviour. They are lightweight, efficient wrappers over the DB clients making use of indexes and native T\+T\+Ls where available.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Database }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Adapter }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Native T\+TL }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Status  }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Database }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Adapter }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Native T\+TL }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Status  }\\\cline{1-4}
\endhead
Redis &\href{https://github.com/lukechilds/keyv-redis}{\texttt{ @keyv/redis}} &Yes &\href{https://travis-ci.org/lukechilds/keyv-redis}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv-redis?branch=master}{\texttt{ }}  \\\cline{1-4}
Mongo\+DB &\href{https://github.com/lukechilds/keyv-mongo}{\texttt{ @keyv/mongo}} &Yes &\href{https://travis-ci.org/lukechilds/keyv-mongo}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv-mongo?branch=master}{\texttt{ }}  \\\cline{1-4}
S\+Q\+Lite &\href{https://github.com/lukechilds/keyv-sqlite}{\texttt{ @keyv/sqlite}} &No &\href{https://travis-ci.org/lukechilds/keyv-sqlite}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv-sqlite?branch=master}{\texttt{ }}  \\\cline{1-4}
Postgre\+S\+QL &\href{https://github.com/lukechilds/keyv-postgres}{\texttt{ @keyv/postgres}} &No &\href{https://travis-ci.org/lukechildskeyv-postgreskeyv}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv-postgres?branch=master}{\texttt{ }}  \\\cline{1-4}
My\+S\+QL &\href{https://github.com/lukechilds/keyv-mysql}{\texttt{ @keyv/mysql}} &No &\href{https://travis-ci.org/lukechilds/keyv-mysql}{\texttt{ }} \href{https://coveralls.io/github/lukechilds/keyv-mysql?branch=master}{\texttt{ }}  \\\cline{1-4}
\end{longtabu}
\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5094}{}\doxysubsection{Third-\/party Storage Adapters}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5094}
You can also use third-\/party storage adapters or build your own. Keyv will wrap these storage adapters in T\+TL functionality and handle complex types internally.


\begin{DoxyCode}{0}
\DoxyCodeLine{const Keyv = require('keyv');}
\DoxyCodeLine{const myAdapter = require('./my-\/storage-\/adapter');}
\DoxyCodeLine{}
\DoxyCodeLine{const keyv = new Keyv(\{ store: myAdapter \});}
\end{DoxyCode}


Any store that follows the \href{https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map}{\texttt{ {\ttfamily Map}}} api will work.


\begin{DoxyCode}{0}
\DoxyCodeLine{new Keyv(\{ store: new Map() \});}
\end{DoxyCode}


For example, \href{https://github.com/sindresorhus/quick-lru}{\texttt{ {\ttfamily quick-\/lru}}} is a completely unrelated module that implements the Map A\+PI.


\begin{DoxyCode}{0}
\DoxyCodeLine{const Keyv = require('keyv');}
\DoxyCodeLine{const QuickLRU = require('quick-\/lru');}
\DoxyCodeLine{}
\DoxyCodeLine{const lru = new QuickLRU(\{ maxSize: 1000 \});}
\DoxyCodeLine{const keyv = new Keyv(\{ store: lru \});}
\end{DoxyCode}


The following are third-\/party storage adapters compatible with Keyv\+:


\begin{DoxyItemize}
\item \href{https://github.com/sindresorhus/quick-lru}{\texttt{ quick-\/lru}} -\/ Simple \char`\"{}\+Least Recently Used\char`\"{} (L\+RU) cache
\item \href{https://github.com/zaaack/keyv-file}{\texttt{ keyv-\/file}} -\/ File system storage adapter for Keyv
\item \href{https://www.npmjs.com/package/keyv-dynamodb}{\texttt{ keyv-\/dynamodb}} -\/ Dynamo\+DB storage adapter for Keyv
\end{DoxyItemize}\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5095}{}\doxysubsection{Add Cache Support to your Module}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5095}
Keyv is designed to be easily embedded into other modules to add cache support. The recommended pattern is to expose a {\ttfamily cache} option in your modules options which is passed through to Keyv. Caching will work in memory by default and users have the option to also install a Keyv storage adapter and pass in a connection string, or any other storage that implements the {\ttfamily Map} A\+PI.

You should also set a namespace for your module so you can safely call {\ttfamily .clear()} without clearing unrelated app data.

Inside your module\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{class AwesomeModule \{}
\DoxyCodeLine{    constructor(opts) \{}
\DoxyCodeLine{        this.cache = new Keyv(\{}
\DoxyCodeLine{            uri: typeof opts.cache === 'string' \&\& opts.cache,}
\DoxyCodeLine{            store: typeof opts.cache !== 'string' \&\& opts.cache,}
\DoxyCodeLine{            namespace: 'awesome-\/module'}
\DoxyCodeLine{        \});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\}}
\end{DoxyCode}


Now it can be consumed like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const AwesomeModule = require('awesome-\/module');}
\DoxyCodeLine{}
\DoxyCodeLine{// Caches stuff in memory by default}
\DoxyCodeLine{const awesomeModule = new AwesomeModule();}
\DoxyCodeLine{}
\DoxyCodeLine{// After npm install -\/-\/save keyv-\/redis}
\DoxyCodeLine{const awesomeModule = new AwesomeModule(\{ cache: 'redis://localhost' \});}
\DoxyCodeLine{}
\DoxyCodeLine{// Some third-\/party module that implements the Map API}
\DoxyCodeLine{const awesomeModule = new AwesomeModule(\{ cache: some3rdPartyStore \});}
\end{DoxyCode}
\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5096}{}\doxysubsection{A\+PI}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5096}
\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5097}{}\doxysubsubsection{new Keyv(\mbox{[}uri\mbox{]}, \mbox{[}options\mbox{]})}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5097}
Returns a new Keyv instance.

The Keyv instance is also an {\ttfamily Event\+Emitter} that will emit an `\textquotesingle{}error'\`{} event if the storage adapter connection fails.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5098}{}\doxysubsubsection{uri}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5098}
Type\+: {\ttfamily String}~\newline
 Default\+: {\ttfamily undefined}

The connection string U\+RI.

Merged into the options object as options.\+uri.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5099}{}\doxysubsubsection{options}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5099}
Type\+: {\ttfamily Object}

The options object is also passed through to the storage adapter. Check your storage adapter docs for any extra options.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5100}{}\doxyparagraph{options.\+namespace}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5100}
Type\+: {\ttfamily String}~\newline
 Default\+: `\textquotesingle{}keyv'\`{}

Namespace for the current instance.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5101}{}\doxyparagraph{options.\+ttl}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5101}
Type\+: {\ttfamily Number}~\newline
 Default\+: {\ttfamily undefined}

Default T\+TL. Can be overridden by specififying a T\+TL on {\ttfamily .set()}.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5102}{}\doxyparagraph{options.\+serialize}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5102}
Type\+: {\ttfamily Function}~\newline
 Default\+: {\ttfamily J\+S\+O\+N\+B.\+stringify}

A custom serialization function.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5103}{}\doxyparagraph{options.\+deserialize}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5103}
Type\+: {\ttfamily Function}~\newline
 Default\+: {\ttfamily J\+S\+O\+N\+B.\+parse}

A custom deserialization function.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5104}{}\doxyparagraph{options.\+store}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5104}
Type\+: {\ttfamily Storage adapter instance}~\newline
 Default\+: {\ttfamily new Map()}

The storage adapter instance to be used by Keyv.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5105}{}\doxyparagraph{options.\+adapter}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5105}
Type\+: {\ttfamily String}~\newline
 Default\+: {\ttfamily undefined}

Specify an adapter to use. e.\+g `\textquotesingle{}redis'{\ttfamily or}\textquotesingle{}mongodb\textquotesingle{}\`{}.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5106}{}\doxysubsubsection{Instance}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5106}
Keys must always be strings. Values can be of any type.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5107}{}\doxyparagraph{.\+set(key, value, \mbox{[}ttl\mbox{]})}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5107}
Set a value.

By default keys are persistent. You can set an expiry T\+TL in milliseconds.

Returns {\ttfamily true}.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5108}{}\doxyparagraph{.\+get(key)}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5108}
Returns the value.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5109}{}\doxyparagraph{.\+delete(key)}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5109}
Deletes an entry.

Returns {\ttfamily true} if the key existed, {\ttfamily false} if not.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5110}{}\doxyparagraph{.\+clear()}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5110}
Delete all entries in the current namespace.

Returns {\ttfamily undefined}.\hypertarget{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5111}{}\doxysubsection{License}\label{md__c_1__git_hub__p_r_o_y_e_c_t_o-_i_i_i-_g_o_t_rest-api-node-mysql_node_modules_keyv__r_e_a_d_m_e_autotoc_md5111}
M\+IT © Luke Childs 